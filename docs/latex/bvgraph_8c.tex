\hypertarget{bvgraph_8c}{\section{src/bvgraph.c File Reference}
\label{bvgraph_8c}\index{src/bvgraph.\+c@{src/bvgraph.\+c}}
}


implementation the routines in \hyperlink{bvgraph_8h}{bvgraph.\+h}  


{\ttfamily \#include \char`\"{}bvgraph\+\_\+internal.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}bvgraph\+\_\+inline\+\_\+io.\+h\char`\"{}}\\*
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{structbvgraph__tag}{bvgraph} $\ast$ \hyperlink{bvgraph_8c_a3d83d353195292c1ac1b5122f0f160d1}{bvgraph\+\_\+new} (void)
\item 
void \hyperlink{bvgraph_8c_a2e646e59c5bf70818e7495b4e192f65e}{bvgraph\+\_\+free} (\hyperlink{structbvgraph__tag}{bvgraph} $\ast$g)
\item 
int \hyperlink{bvgraph_8c_ae1dfa094776c463224625630ca654b7c}{bvgraph\+\_\+load} (\hyperlink{structbvgraph__tag}{bvgraph} $\ast$g, const char $\ast$filename, unsigned int filenamelen, int offset\+\_\+step)
\item 
int \hyperlink{bvgraph_8c_aa815fcc22af8cd3e1e5fc2dfc2a19ac9}{bvgraph\+\_\+load\+\_\+external} (\hyperlink{structbvgraph__tag}{bvgraph} $\ast$g, const char $\ast$filename, unsigned int filenamelen, int offset\+\_\+step, unsigned char $\ast$gmemory, size\+\_\+t gmemsize, unsigned long long $\ast$offsets, int offsetssize)
\item 
int \hyperlink{bvgraph_8c_a31308c861752f08792a4482bca9cc9ef}{bvgraph\+\_\+close} (\hyperlink{structbvgraph__tag}{bvgraph} $\ast$g)
\item 
int \hyperlink{bvgraph_8c_ae07da12e465b2b8264ce43ac8ebaab11}{bvgraph\+\_\+required\+\_\+memory} (\hyperlink{structbvgraph__tag}{bvgraph} $\ast$g, int offset\+\_\+step, size\+\_\+t $\ast$gbuf, size\+\_\+t $\ast$offsetbuf)
\item 
int \hyperlink{bvgraph_8c_a264d0ff560674482dceede5f4d3ad44f}{bvgraph\+\_\+outdegree} (\hyperlink{structbvgraph__tag}{bvgraph} $\ast$g, int64\+\_\+t x, uint64\+\_\+t $\ast$d)
\item 
int \hyperlink{bvgraph_8c_ae6077e3021b42d4a488b2bda116df72a}{bvgraph\+\_\+successors} (\hyperlink{structbvgraph__tag}{bvgraph} $\ast$g, int64\+\_\+t x, int64\+\_\+t $\ast$$\ast$start, uint64\+\_\+t $\ast$length)
\item 
const char $\ast$ \hyperlink{bvgraph_8c_acc071b45a48a56af159cb83228c25f17}{bvgraph\+\_\+error\+\_\+string} (int code)
\end{DoxyCompactItemize}
\subsection*{Variables}
\begin{DoxyCompactItemize}
\item 
const int \hyperlink{bvgraph_8c_acf8e5a019558a8623a2355214e99d34b}{bvgraph\+\_\+call\+\_\+out\+\_\+of\+\_\+memory} = -\/1
\begin{DoxyCompactList}\small\item\em error code for call out of memory \end{DoxyCompactList}\item 
\hypertarget{bvgraph_8c_a92c51757cff8f0b08a8301ce70c4aad6}{const int \hyperlink{bvgraph_8c_a92c51757cff8f0b08a8301ce70c4aad6}{bvgraph\+\_\+call\+\_\+io\+\_\+error} = -\/2}\label{bvgraph_8c_a92c51757cff8f0b08a8301ce70c4aad6}

\begin{DoxyCompactList}\small\item\em error code for io error \end{DoxyCompactList}\item 
\hypertarget{bvgraph_8c_a2dea3056474a6410da55fe53aadde9ad}{const int \hyperlink{bvgraph_8c_a2dea3056474a6410da55fe53aadde9ad}{bvgraph\+\_\+call\+\_\+unsupported} = -\/3}\label{bvgraph_8c_a2dea3056474a6410da55fe53aadde9ad}

\begin{DoxyCompactList}\small\item\em error code for unsupported call \end{DoxyCompactList}\item 
\hypertarget{bvgraph_8c_a53cb7f7c14e9e210072161341e85b059}{const int \hyperlink{bvgraph_8c_a53cb7f7c14e9e210072161341e85b059}{bvgraph\+\_\+load\+\_\+error\+\_\+filename\+\_\+too\+\_\+long} = 11}\label{bvgraph_8c_a53cb7f7c14e9e210072161341e85b059}

\begin{DoxyCompactList}\small\item\em error code for file name too long \end{DoxyCompactList}\item 
\hypertarget{bvgraph_8c_aee13c4ca45e5bb4bd7241711b5dc907f}{const int \hyperlink{bvgraph_8c_aee13c4ca45e5bb4bd7241711b5dc907f}{bvgraph\+\_\+load\+\_\+error\+\_\+buffer\+\_\+too\+\_\+small} = 12}\label{bvgraph_8c_aee13c4ca45e5bb4bd7241711b5dc907f}

\begin{DoxyCompactList}\small\item\em error code for buffer too small \end{DoxyCompactList}\item 
\hypertarget{bvgraph_8c_ad5282955d219e20f9a45ed7e7e003601}{const int \hyperlink{bvgraph_8c_ad5282955d219e20f9a45ed7e7e003601}{bvgraph\+\_\+property\+\_\+file\+\_\+error} = 21}\label{bvgraph_8c_ad5282955d219e20f9a45ed7e7e003601}

\begin{DoxyCompactList}\small\item\em error code for property file \end{DoxyCompactList}\item 
\hypertarget{bvgraph_8c_a11a35d14f88de676205609855254ae65}{const int \hyperlink{bvgraph_8c_a11a35d14f88de676205609855254ae65}{bvgraph\+\_\+unsupported\+\_\+version} = 22}\label{bvgraph_8c_a11a35d14f88de676205609855254ae65}

\begin{DoxyCompactList}\small\item\em error code for unsupported version \end{DoxyCompactList}\item 
\hypertarget{bvgraph_8c_a969ef9247587a940a26065a7f78c9560}{const int \hyperlink{bvgraph_8c_a969ef9247587a940a26065a7f78c9560}{bvgraph\+\_\+property\+\_\+file\+\_\+compression\+\_\+flag\+\_\+error} = 23}\label{bvgraph_8c_a969ef9247587a940a26065a7f78c9560}

\begin{DoxyCompactList}\small\item\em error code for property file compression flag \end{DoxyCompactList}\item 
\hypertarget{bvgraph_8c_abb6b624c0dd9d9e3765dc73ea221084f}{const int \hyperlink{bvgraph_8c_abb6b624c0dd9d9e3765dc73ea221084f}{bvgraph\+\_\+vertex\+\_\+out\+\_\+of\+\_\+range} = 31}\label{bvgraph_8c_abb6b624c0dd9d9e3765dc73ea221084f}

\begin{DoxyCompactList}\small\item\em error code for vertex out of range \end{DoxyCompactList}\item 
\hypertarget{bvgraph_8c_ab55859a22117460011e63f33682924d6}{const int \hyperlink{bvgraph_8c_ab55859a22117460011e63f33682924d6}{bvgraph\+\_\+requires\+\_\+offsets} = 32}\label{bvgraph_8c_ab55859a22117460011e63f33682924d6}

\begin{DoxyCompactList}\small\item\em error code for missing offsets \end{DoxyCompactList}\item 
\hypertarget{bvgraph_8c_a3cfb93041a4819f67ea60c54106838e9}{const int \hyperlink{bvgraph_8c_a3cfb93041a4819f67ea60c54106838e9}{bvgraph\+\_\+unsupported\+\_\+coding} = 33}\label{bvgraph_8c_a3cfb93041a4819f67ea60c54106838e9}

\begin{DoxyCompactList}\small\item\em error code for unsupported coding method \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Detailed Description}
implementation the routines in \hyperlink{bvgraph_8h}{bvgraph.\+h} 

Implement all the routines to work with bvgraph files in the bvg library. \begin{DoxyAuthor}{Author}
David Gleich 
\end{DoxyAuthor}
\begin{DoxyDate}{Date}
17 May 2007 
\end{DoxyDate}
\begin{DoxyVersion}{Version}

\end{DoxyVersion}
01-\/24-\/2008\+: Added function to initialize structure memory to fix a segfault on the 32-\/bit version. 

\subsection{Function Documentation}
\hypertarget{bvgraph_8c_a31308c861752f08792a4482bca9cc9ef}{\index{bvgraph.\+c@{bvgraph.\+c}!bvgraph\+\_\+close@{bvgraph\+\_\+close}}
\index{bvgraph\+\_\+close@{bvgraph\+\_\+close}!bvgraph.\+c@{bvgraph.\+c}}
\subsubsection[{bvgraph\+\_\+close}]{\setlength{\rightskip}{0pt plus 5cm}int bvgraph\+\_\+close (
\begin{DoxyParamCaption}
\item[{{\bf bvgraph} $\ast$}]{g}
\end{DoxyParamCaption}
)}}\label{bvgraph_8c_a31308c861752f08792a4482bca9cc9ef}
Close a bvgraph object. This operation will free any associated memory. However, it will leave any existing iterators in an zombie state. These iterators should be closed before closing the graph, but this is only recommended to avoid bugs.

\begin{DoxyRefDesc}{Todo}
\item[\hyperlink{todo__todo000001}{Todo}]Implement a \char`\"{}valid\char`\"{} function that all the iterators would check?\end{DoxyRefDesc}



\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em g} & the graph \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 on success 
\end{DoxyReturn}
\hypertarget{bvgraph_8c_acc071b45a48a56af159cb83228c25f17}{\index{bvgraph.\+c@{bvgraph.\+c}!bvgraph\+\_\+error\+\_\+string@{bvgraph\+\_\+error\+\_\+string}}
\index{bvgraph\+\_\+error\+\_\+string@{bvgraph\+\_\+error\+\_\+string}!bvgraph.\+c@{bvgraph.\+c}}
\subsubsection[{bvgraph\+\_\+error\+\_\+string}]{\setlength{\rightskip}{0pt plus 5cm}const char$\ast$ bvgraph\+\_\+error\+\_\+string (
\begin{DoxyParamCaption}
\item[{int}]{code}
\end{DoxyParamCaption}
)}}\label{bvgraph_8c_acc071b45a48a56af159cb83228c25f17}
Return an error string associated with an error code.


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em code} & the error code \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
the pointer to a string associated with an error code. 
\end{DoxyReturn}
\hypertarget{bvgraph_8c_a2e646e59c5bf70818e7495b4e192f65e}{\index{bvgraph.\+c@{bvgraph.\+c}!bvgraph\+\_\+free@{bvgraph\+\_\+free}}
\index{bvgraph\+\_\+free@{bvgraph\+\_\+free}!bvgraph.\+c@{bvgraph.\+c}}
\subsubsection[{bvgraph\+\_\+free}]{\setlength{\rightskip}{0pt plus 5cm}void bvgraph\+\_\+free (
\begin{DoxyParamCaption}
\item[{{\bf bvgraph} $\ast$}]{g}
\end{DoxyParamCaption}
)}}\label{bvgraph_8c_a2e646e59c5bf70818e7495b4e192f65e}
Free a bvgraph in the memory. 
\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em g} & a pointer to the bvgraph in the memory \\
\hline
\end{DoxyParams}
\hypertarget{bvgraph_8c_ae1dfa094776c463224625630ca654b7c}{\index{bvgraph.\+c@{bvgraph.\+c}!bvgraph\+\_\+load@{bvgraph\+\_\+load}}
\index{bvgraph\+\_\+load@{bvgraph\+\_\+load}!bvgraph.\+c@{bvgraph.\+c}}
\subsubsection[{bvgraph\+\_\+load}]{\setlength{\rightskip}{0pt plus 5cm}int bvgraph\+\_\+load (
\begin{DoxyParamCaption}
\item[{{\bf bvgraph} $\ast$}]{g, }
\item[{const char $\ast$}]{filename, }
\item[{unsigned int}]{filenamelen, }
\item[{int}]{offset\+\_\+step}
\end{DoxyParamCaption}
)}}\label{bvgraph_8c_ae1dfa094776c463224625630ca654b7c}
Load the metadata associated with a bvgraph. Largely, this involves just parsing the properties files.


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em g} & a newly created bvgraph structure \\
\hline
\mbox{\tt in}  & {\em filename} & the base filename for a set of bvgraph files, so filename.\+graph and filename.\+properties must exist. \\
\hline
\mbox{\tt in}  & {\em offset\+\_\+step} & controls how many offsets are loaded, if offset\+\_\+step = -\/1, then the graph file isn't loaded into memory if offset\+\_\+step = 0, then the graph file is loaded, but no offsets no other values are supported at the moment. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 if successful; bvgraph\+\_\+load\+\_\+error\+\_\+filename\+\_\+too\+\_\+long -\/ indicates the filename was too long
\end{DoxyReturn}

\begin{DoxyCode}
\hyperlink{structbvgraph__tag}{bvgraph} g; \hyperlink{bvgraph_8c_ae1dfa094776c463224625630ca654b7c}{bvgraph\_load}(&b, \textcolor{stringliteral}{"cnr-2000"}, 0);
\end{DoxyCode}
 \hypertarget{bvgraph_8c_aa815fcc22af8cd3e1e5fc2dfc2a19ac9}{\index{bvgraph.\+c@{bvgraph.\+c}!bvgraph\+\_\+load\+\_\+external@{bvgraph\+\_\+load\+\_\+external}}
\index{bvgraph\+\_\+load\+\_\+external@{bvgraph\+\_\+load\+\_\+external}!bvgraph.\+c@{bvgraph.\+c}}
\subsubsection[{bvgraph\+\_\+load\+\_\+external}]{\setlength{\rightskip}{0pt plus 5cm}int bvgraph\+\_\+load\+\_\+external (
\begin{DoxyParamCaption}
\item[{{\bf bvgraph} $\ast$}]{g, }
\item[{const char $\ast$}]{filename, }
\item[{unsigned int}]{filenamelen, }
\item[{int}]{offset\+\_\+step, }
\item[{unsigned char $\ast$}]{gmemory, }
\item[{size\+\_\+t}]{gmemsize, }
\item[{unsigned long long $\ast$}]{offsets, }
\item[{int}]{offsetssize}
\end{DoxyParamCaption}
)}}\label{bvgraph_8c_aa815fcc22af8cd3e1e5fc2dfc2a19ac9}
Load a graph file but using a set of externally provided buffers for the data. This might be useful in the case that you want to managed memory for the graph independently of this function.

To maintain the graph, only the bvgraph structure, and the two external ararys\+: gmemory and offsets are required. Consequently, a bvgraph structure can always be patched together out of these functions.

One common way of using this function would be to first load a graph on the disk (bvgraph\+\_\+load(...,offset\+\_\+step=-\/1)) and then call bvgraph\+\_\+required\+\_\+memory with an alternative offset step.


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em g} & a newly created bvgraph structure \\
\hline
\mbox{\tt in}  & {\em filename} & the base filename for a set of bvgraph files, so filename.\+graph and filename.\+properties must exist. \\
\hline
\mbox{\tt in}  & {\em offset\+\_\+step} & controls how many offsets are loaded, if offset\+\_\+step = -\/1, then the graph file isn't loaded into memory if offset\+\_\+step = 0, then the graph file is loaded, but no offsets no other values are supported at the moment. \\
\hline
\mbox{\tt in}  & {\em gmemory} & an arry of size gmemsize for the graph (if N\+U\+L\+L, then this parameter is treated as internal memory) \\
\hline
\mbox{\tt in}  & {\em gmemsize} & the size of the gmemory block \\
\hline
\mbox{\tt in}  & {\em offsets} & an array of offsets (if N\+U\+L\+L, then this parameter is treated as internal memory) \\
\hline
\mbox{\tt in}  & {\em offsetssize} & the number of offsets \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 if successful; bvgraph\+\_\+load\+\_\+error\+\_\+filename\+\_\+too\+\_\+long -\/ indicates the filename was too long 
\end{DoxyReturn}
\hypertarget{bvgraph_8c_a3d83d353195292c1ac1b5122f0f160d1}{\index{bvgraph.\+c@{bvgraph.\+c}!bvgraph\+\_\+new@{bvgraph\+\_\+new}}
\index{bvgraph\+\_\+new@{bvgraph\+\_\+new}!bvgraph.\+c@{bvgraph.\+c}}
\subsubsection[{bvgraph\+\_\+new}]{\setlength{\rightskip}{0pt plus 5cm}{\bf bvgraph}$\ast$ bvgraph\+\_\+new (
\begin{DoxyParamCaption}
\item[{void}]{}
\end{DoxyParamCaption}
)}}\label{bvgraph_8c_a3d83d353195292c1ac1b5122f0f160d1}
Create a new bvgraph in the memory. \begin{DoxyReturn}{Returns}
A pointer to the newly created bvgraph in the memory. 
\end{DoxyReturn}
\hypertarget{bvgraph_8c_a264d0ff560674482dceede5f4d3ad44f}{\index{bvgraph.\+c@{bvgraph.\+c}!bvgraph\+\_\+outdegree@{bvgraph\+\_\+outdegree}}
\index{bvgraph\+\_\+outdegree@{bvgraph\+\_\+outdegree}!bvgraph.\+c@{bvgraph.\+c}}
\subsubsection[{bvgraph\+\_\+outdegree}]{\setlength{\rightskip}{0pt plus 5cm}int bvgraph\+\_\+outdegree (
\begin{DoxyParamCaption}
\item[{{\bf bvgraph} $\ast$}]{g, }
\item[{int64\+\_\+t}]{x, }
\item[{uint64\+\_\+t $\ast$}]{d}
\end{DoxyParamCaption}
)}}\label{bvgraph_8c_a264d0ff560674482dceede5f4d3ad44f}
Access the outdegree for a given node.

For a random access graph, this method provides a thread-\/safe means of getting the outdegree for a given node. If you are going to make many sequential outdegree calls from a single thread, the random\+\_\+access\+\_\+iterator structure is much more efficient.

To use this method, the graph must be loaded with offsets.


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em g} & the bvgraph structure with offsets loaded \\
\hline
\mbox{\tt in}  & {\em x} & the node \\
\hline
\mbox{\tt out}  & {\em d} & the outdegree \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 on success 
\end{DoxyReturn}
\hypertarget{bvgraph_8c_ae07da12e465b2b8264ce43ac8ebaab11}{\index{bvgraph.\+c@{bvgraph.\+c}!bvgraph\+\_\+required\+\_\+memory@{bvgraph\+\_\+required\+\_\+memory}}
\index{bvgraph\+\_\+required\+\_\+memory@{bvgraph\+\_\+required\+\_\+memory}!bvgraph.\+c@{bvgraph.\+c}}
\subsubsection[{bvgraph\+\_\+required\+\_\+memory}]{\setlength{\rightskip}{0pt plus 5cm}int bvgraph\+\_\+required\+\_\+memory (
\begin{DoxyParamCaption}
\item[{{\bf bvgraph} $\ast$}]{g, }
\item[{int}]{offset\+\_\+step, }
\item[{size\+\_\+t $\ast$}]{gbuf, }
\item[{size\+\_\+t $\ast$}]{offsetbuf}
\end{DoxyParamCaption}
)}}\label{bvgraph_8c_ae07da12e465b2b8264ce43ac8ebaab11}
Compute the memory required to load a bvgraph into memory with the desired offset\+\_\+step.

The best way to use this function is to load the bvgraph with offset\+\_\+step = -\/1, and then call this function to determine how much additional memory is required.


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em g} & the graph \\
\hline
\mbox{\tt in}  & {\em offset\+\_\+step} & the new offset\+\_\+step value \\
\hline
\mbox{\tt out}  & {\em gbuf} & the size of the graph buffer \\
\hline
\mbox{\tt out}  & {\em offsetbuf} & the size of the offset buffer \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 on success 
\end{DoxyReturn}
\hypertarget{bvgraph_8c_ae6077e3021b42d4a488b2bda116df72a}{\index{bvgraph.\+c@{bvgraph.\+c}!bvgraph\+\_\+successors@{bvgraph\+\_\+successors}}
\index{bvgraph\+\_\+successors@{bvgraph\+\_\+successors}!bvgraph.\+c@{bvgraph.\+c}}
\subsubsection[{bvgraph\+\_\+successors}]{\setlength{\rightskip}{0pt plus 5cm}int bvgraph\+\_\+successors (
\begin{DoxyParamCaption}
\item[{{\bf bvgraph} $\ast$}]{g, }
\item[{int64\+\_\+t}]{x, }
\item[{int64\+\_\+t $\ast$$\ast$}]{start, }
\item[{uint64\+\_\+t $\ast$}]{length}
\end{DoxyParamCaption}
)}}\label{bvgraph_8c_ae6077e3021b42d4a488b2bda116df72a}
Access the successors for a given node.

For a random access graph, this method provides a thread-\/safe means of getting the outdegree for a given node. If you are going to make many sequential outdegree calls from a single thread, the random\+\_\+access\+\_\+iterator structure is much more efficient.

To use this method, the graph must be loaded with offsets.


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em g} & the bvgraph structure with offsets loaded \\
\hline
\mbox{\tt in}  & {\em x} & the node \\
\hline
\mbox{\tt out}  & {\em start} & the starting point of successor list \\
\hline
\mbox{\tt out}  & {\em length} & the length of successor list (degree) \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 on success 
\end{DoxyReturn}


\subsection{Variable Documentation}
\hypertarget{bvgraph_8c_acf8e5a019558a8623a2355214e99d34b}{\index{bvgraph.\+c@{bvgraph.\+c}!bvgraph\+\_\+call\+\_\+out\+\_\+of\+\_\+memory@{bvgraph\+\_\+call\+\_\+out\+\_\+of\+\_\+memory}}
\index{bvgraph\+\_\+call\+\_\+out\+\_\+of\+\_\+memory@{bvgraph\+\_\+call\+\_\+out\+\_\+of\+\_\+memory}!bvgraph.\+c@{bvgraph.\+c}}
\subsubsection[{bvgraph\+\_\+call\+\_\+out\+\_\+of\+\_\+memory}]{\setlength{\rightskip}{0pt plus 5cm}const int bvgraph\+\_\+call\+\_\+out\+\_\+of\+\_\+memory = -\/1}}\label{bvgraph_8c_acf8e5a019558a8623a2355214e99d34b}


error code for call out of memory 

Define all the error codes 